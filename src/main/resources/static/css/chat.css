/* ===== Palette (từ ảnh bạn gửi) ===== */
:root{
    --bg: #d9dfdf;          /* light grey */
    --panel: #37363e;       /* deep slate */
    --panel-2: #43444d;     /* slate đậm */
    --me: #705b5c;          /* mauve/coffee - bong bóng của tôi */
    --other: #484a54;       /* slate cho đối phương */
    --soft: #eef1f2;        /* viền & hover */
    --text: #eef1f2;
    --muted: #b9bfc6;
    --brand: #e7e9ec;       /* nhạt để nổi bật trên nền tối */
    --radius: 14px;
    --shadow: 0 10px 26px rgba(0,0,0,.12);
    --maxw: 1120px;
    --sidebar-w: 300px;
    --gap: 16px;
    --font: 15px/1.5 "Inter", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
    margin:0; background:var(--bg); color:#202327; font:var(--font);
}

/* ===== Layout: sidebar (nếu có) + khung chat ===== */
.chat-shell{
    max-width: var(--maxw);
    margin: 28px auto;
    display: grid;
    grid-template-columns: minmax(240px, var(--sidebar-w)) 1fr;
    gap: var(--gap);
    padding: 0 var(--gap);
}

/* Khi trang user không có sidebar, chỉ hiển thị khung chat  */
.chat-shell.only-chat{ grid-template-columns: 1fr; }

/* ===== Sidebar (inbox bên trái khi là admin) ===== */
.chat-sidebar{
    background:#fff; border-radius: var(--radius); padding:14px;
    box-shadow: var(--shadow);
}

.chat-sidebar .search{
    width:100%; height:40px; padding:10px 12px;
    border:1px solid var(--soft); border-radius:10px; outline:none;
}
.chat-sidebar .search:focus{
    border-color: var(--panel-2); box-shadow: 0 0 0 3px rgba(67,68,77,.15);
}

.chat-sidebar .total{ margin:10px 2px 8px; color:#68707a; font-size:13px; }

.inbox{
    margin-top:6px; display:flex; flex-direction:column; gap:10px;
    max-height: calc(80vh - 120px); overflow:auto;
}
.inbox-item{
    display:grid; grid-template-columns:auto 1fr auto;
    gap:10px; align-items:center;
    padding:10px 12px; border:1px solid var(--soft);
    border-radius:12px; cursor:pointer; background:#fff;
}
.inbox-item:hover{ background:#fafbfc; }
.inbox-item.active{ outline:2px solid var(--panel-2); }
.inbox-item .email{ font-weight:600; }
.inbox-item .preview{ grid-column: 1 / -1; color:#6b737d; font-size:13px; margin-top:2px; }
.inbox-item .badge{
    background:#e54b4b; color:#fff; font-weight:700;
    border-radius:999px; padding:2px 8px; font-size:12px;
}
.inbox-item .del{
    border:0; background:#f1f3f5; color:#444; width:24px; height:24px;
    border-radius:8px; cursor:pointer;
}
.inbox-item .del:hover{ background:#e7eaee; }

/* ===== Khung chat bên phải ===== */
.chat-board{
    background: #fff; border-radius: var(--radius); box-shadow: var(--shadow);
    overflow:hidden; display:flex; flex-direction:column; min-height: 72vh;
}

/* Header */
.chat-header{
    background: var(--panel); color: var(--brand);
    padding: 14px 18px; font-weight: 700; letter-spacing:.2px;
    display:flex; justify-content:space-between; align-items:center;
}
.chat-header .peer{ color:#cfd4da; font-weight:600; }

/* Nội dung tin nhắn */
#chatArea{
    padding:18px; overflow:auto; flex:1;
    background: #fff;
}

/* Bubbles */
.msg{ display:flex; margin:8px 0; }
.msg.me{ justify-content:flex-end; }
.msg.system{ justify-content:center; }
.msg .bubble{
    max-width: 68ch; border-radius:16px; padding:10px 12px;
    background: var(--other); color: var(--text);
}
.msg.me .bubble{ background: var(--me); }
.msg.system .bubble{ background:#f3f4f6; color:#374151; }
.msg .sender{ font-size:12px; opacity:.9; margin-bottom:4px; font-weight:600; }
.msg .text{ white-space:pre-wrap; word-wrap:break-word; }

/* Input row */
.chat-input{
    border-top:1px solid var(--soft);
    padding:10px; display:flex; gap:8px; align-items:center;
    background:#fff;
}
#msg{
    flex:1; height:44px; padding:12px 12px;
    border:1px solid var(--soft); border-radius:12px; outline:none;
    background:#fff; font:inherit;
}
#msg:focus{ border-color: var(--panel-2); box-shadow:0 0 0 3px rgba(67,68,77,.15); }
#sendBtn{
    padding:11px 16px; border-radius:12px; border:0; cursor:pointer;
    background: var(--panel-2); color: var(--brand); font-weight:700;
}
#sendBtn:hover{ background:#3b3c45; }

/* ===== Responsive ===== */
@media (max-width: 920px){
    .chat-shell{ grid-template-columns: 1fr; }
    .chat-sidebar{ order:2 }
    .chat-board{ order:1 }
}
