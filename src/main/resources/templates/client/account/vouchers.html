<!DOCTYPE html>
<html lang="vi"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{client/layout/base}">

<body>
<th:block layout:fragment="headExtras">
    <link rel="stylesheet" th:href="@{/css/profile.css}"/>
</th:block>

<div layout:fragment="content" class="profile-page">
    <!-- <section class="banner banner--simple">
        <div class="banner-card banner-card--compact">
            <div class="banner-left">
                <h2>Ví Voucher</h2>
                <p class="muted">Nhập mã để nhận ưu đãi cho đơn hàng tiếp theo.</p>
            </div>
            <a class="btn" th:href="@{/}">Tiếp tục mua sắm</a>
        </div>
    </section> -->

    <div class="wrap">
        <div th:replace="~{client/account/fragments/sidebar :: sidebar(active=${active})}"></div>

        <main>
            <div class="card">
                <h1 class="h1">Mã giảm giá của bạn</h1>

                <div class="voucher-list"
                     th:if="${vouchers != null and !vouchers.isEmpty()}">
                    <article class="voucher-card" th:each="voucher : ${vouchers}">
                        <div class="voucher-card__code">
                            <span th:text="${voucher.code()}">XMATE50K</span>
                            <button type="button" class="voucher-card__copy"
                                    th:data-code="${voucher.code()}">Sao chép</button>
                        </div>
                        <p class="voucher-card__value" th:text="${voucher.valueText()}">Giảm 50.000đ</p>
                        <p class="voucher-card__desc" th:text="${voucher.description()}">Mô tả</p>
                        <ul class="voucher-card__meta">
                            <li th:text="${voucher.minOrderText()}">Đơn tối thiểu</li>
                            <li th:text="'Hạn sử dụng: ' + ${voucher.expiryText()}">31/12/2025</li>
                        </ul>
                        <button class="btn btn--ghost" type="button">Dùng ngay</button>
                    </article>
                </div>

                <div class="empty-block"
                     th:if="${vouchers == null or vouchers.isEmpty()}">
                    <p>Hiện bạn chưa có voucher nào khả dụng.</p>
                    <p class="muted">Tiếp tục săn khuyến mãi để nhận thêm ưu đãi nhé!</p>
                </div>
            </div>
        </main>
    </div>
</div>

<th:block layout:fragment="bodyExtras">
    <script th:src="@{/js/profile.js}"></script>
    <script>
        document.addEventListener('click', function (e) {
            var copyBtn = e.target.closest('.voucher-card__copy');
            if (!copyBtn) return;
            var code = copyBtn.getAttribute('data-code');
            if (!code) return;
            navigator.clipboard.writeText(code).then(function () {
                copyBtn.textContent = 'Đã sao chép';
                setTimeout(function () {
                    copyBtn.textContent = 'Sao chép';
                }, 2000);
            });
        });
    </script>
</th:block>
</body>
</html>
