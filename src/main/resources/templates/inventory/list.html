<!--<!DOCTYPE html>-->
<!--<html lang="vi"-->
<!--      xmlns:th="http://www.thymeleaf.org"-->
<!--      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"-->
<!--      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"-->
<!--      layout:decorate="~{layout/main}">-->
<!--<body>-->
<!--<section layout:fragment="content">-->
<!--    &lt;!&ndash; Khi KHÔNG có quyền VIEW &ndash;&gt;-->
<!--    <div class="alert alert-warning" sec:authorize="!hasAnyAuthority('INVENTORY_VIEW','ROLE_ADMIN')">-->
<!--        Bạn không có quyền xem tồn kho.-->
<!--    </div>-->

<!--    &lt;!&ndash; Khi CÓ quyền VIEW &ndash;&gt;-->
<!--    <div sec:authorize="hasAnyAuthority('INVENTORY_VIEW','ROLE_ADMIN')">-->
<!--        <h1 class="page-title">Inventory</h1>-->

<!--        <div class="d-flex align-items-center justify-content-between gap-2 mb-3">-->
<!--            <form method="get" th:action="@{/admin/inventory}" class="d-flex align-items-center gap-2">-->
<!--                <input class="form-control" type="text" name="q" th:value="${q}" placeholder="Tìm theo SKU / Product / Color / Size">-->
<!--                <button class="btn btn-primary" type="submit">Search</button>-->
<!--            </form>-->
<!--        </div>-->

<!--        <div class="table-responsive">-->
<!--            <table class="table table-striped table-hover align-middle w-100">-->
<!--                <thead class="table-light">-->
<!--                <tr>-->
<!--                    <th>Variant ID</th>-->
<!--                    <th>SKU</th>-->
<!--                    <th>Product</th>-->
<!--                    <th>Color</th>-->
<!--                    <th>Size</th>-->
<!--                    <th class="text-end">On Hand</th>-->
<!--                    <th class="text-end">Reserved</th>-->
<!--                    <th class="text-end">Available</th>-->
<!--                    <th>Updated</th>-->
<!--                    <th style="width:160px;">Actions</th>-->
<!--                </tr>-->
<!--                </thead>-->
<!--                <tbody>-->
<!--                <tr th:each="i : ${page?.content}">-->
<!--                    <td th:text="${i.variantId}">1</td>-->
<!--                    <td th:text="${i.variant?.sku}">SKU</td>-->
<!--                    <td th:text="${i.variant?.product?.name}">Tee</td>-->
<!--                    <td th:text="${i.variant?.color}">Red</td>-->
<!--                    <td th:text="${i.variant?.size}">M</td>-->
<!--                    <td class="text-end" th:text="${i.qtyOnHand}">0</td>-->
<!--                    <td class="text-end" th:text="${i.qtyReserved}">0</td>-->
<!--                    <td class="text-end" th:text="${i.qtyOnHand - i.qtyReserved}">0</td>-->
<!--                    <td th:text="${i.updatedAt != null ? #temporals.format(i.updatedAt,'yyyy-MM-dd HH:mm') : ''}"></td>-->
<!--                    <td class="d-flex gap-2">-->
<!--                        &lt;!&ndash; Adjust chỉ hiển thị khi có quyền ADJUST hoặc ROLE_ADMIN &ndash;&gt;-->
<!--                        <a th:href="@{/admin/inventory/adjust/{id}(id=${i.variantId})}"-->
<!--                           class="btn btn-sm btn-secondary"-->
<!--                           sec:authorize="hasAnyAuthority('INVENTORY_ADJUST','ROLE_ADMIN')">Adjust</a>-->
<!--                    </td>-->
<!--                </tr>-->
<!--                <tr th:if="${page == null || #lists.isEmpty(page.content)}">-->
<!--                    <td colspan="10" class="text-center">No data</td>-->
<!--                </tr>-->
<!--                </tbody>-->
<!--            </table>-->
<!--        </div>-->

<!--        <div th:replace="~{layout/components/_pagination :: body(page=${page}, baseUrl='/admin/inventory', q=${q})}"></div>-->
<!--    </div>-->
<!--</section>-->
<!--</body>-->
<!--</html>-->
<!DOCTYPE html>
<html lang="vi"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main}">
<head>
    <meta charset="UTF-8">
    <title>Danh sách tồn kho</title>
    <style>
        :root{
            --bg:#f8fafc;
            --surface:#ffffff;
            --text:#0f172a;
            --muted:#64748b;
            --bd:#e2e8f0;
            --ring:#93c5fd;
            --primary:#2563eb;
            --primary-hover:#1d4ed8;
            --success:#16a34a;            /* xanh lá mới */
            --success-hover:#15803d;
        }

        .toolbar{
            display:flex;
            justify-content:flex-start;   /* ✅ căn trái */
            align-items:center;
            gap:10px;
            flex-wrap:wrap;
            margin-bottom:16px;
        }

        .search-form{
            display:flex;
            align-items:center;
            gap:10px;
            flex-wrap:wrap;
        }

        .control{
            height:40px;
            display:inline-flex;
            align-items:center;
            border:1px solid var(--bd);
            border-radius:12px;
            background:var(--surface);
            padding:0 .9rem;
            font-size:.95rem;
            color:var(--text);
            transition:.18s;
        }
        .control:focus-within{box-shadow:0 0 0 3px var(--ring);border-color:var(--primary);}
        .control input{
            border:none;
            outline:none;
            background:transparent;
            height:100%;
            width:360px;
            max-width:70vw;
            font-size:.95rem;
            color:var(--text);
        }

        .btn{
            height:40px;
            padding:0 14px;
            border-radius:12px;
            border:1px solid transparent;
            display:inline-flex;
            align-items:center;
            gap:.45rem;
            cursor:pointer;
            font-weight:700;
            font-size:.9rem;
            line-height:1;
            transition:.18s;
        }

        .btn-primary{background:var(--primary);color:#fff;}
        .btn-primary:hover{background:var(--primary-hover);}
        .btn-success{background:var(--success);color:#fff;}      /* ✅ màu mới */
        .btn-success:hover{background:var(--success-hover);}
    </style>

</head>
<body>
<section layout:fragment="content">
    <div class="wrap">
        <h1 class="page-title">Danh sách tồn kho</h1>

        <div class="toolbar">
            <form method="get" th:action="@{/admin/inventory}" class="search-form">
                <label class="control">
                    <input type="text" name="q" th:value="${q}" placeholder="Tìm theo SKU / Sản phẩm / Màu / Size">
                </label>
                <button class="btn btn-primary" type="submit">Tìm kiếm</button>
                <a th:href="@{/admin/inventory}" class="btn btn-success">Xem tất cả</a>  <!-- ✅ đổi màu xanh lá -->
            </form>
        </div>

        <div class="table-card">
            <div class="table-responsive">
                <table class="table align-middle">
                    <thead>
                    <tr>
                        <th class="col-center">Variant ID</th>
                        <th class="col-left">Mã SKU</th>
                        <th class="col-left">Sản phẩm</th>
                        <th class="col-left">Màu sắc</th>
                        <th class="col-left">Kích cỡ</th>
                        <th class="col-right">Tồn kho</th>
                        <th class="col-right">Đã đặt</th>
                        <th class="col-right">Khả dụng</th>
                        <th class="col-center">Cập nhật</th>
                        <th class="col-right" style="width:170px;">Thao tác</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="i : ${page?.content}">
                        <td class="col-center" th:text="${i.variantId}">101</td>
                        <td class="col-left col-sku"><span class="truncate" th:title="${i.variant?.sku}" th:text="${i.variant?.sku}">TSK-BLU-L</span></td>
                        <td class="col-left col-name"><span class="truncate" th:title="${i.variant?.product?.name}" th:text="${i.variant?.product?.name}">Sản phẩm mẫu chung</span></td>
                        <td class="col-left" th:text="${i.variant?.color}">Xanh Dương</td>
                        <td class="col-left" th:text="${i.variant?.size}">L</td>
                        <td class="col-right" th:text="${#numbers.formatInteger(i.qtyOnHand, 0)}">150</td>
                        <td class="col-right" th:text="${#numbers.formatInteger(i.qtyReserved, 0)}">5</td>
                        <td class="col-right" th:text="${#numbers.formatInteger(i.qtyOnHand - i.qtyReserved, 0)}">145</td>
                        <td class="col-center" th:text="${i.updatedAt != null ? #temporals.format(i.updatedAt,'dd/MM/yyyy HH:mm') : '—'}">25/10/2025 21:35</td>
                        <td>
                            <div class="actions">
                                <a th:href="@{/admin/inventory/adjust/{id}(id=${i.variantId})}"
                                   class="btn btn-sm btn-secondary"
                                   sec:authorize="hasAnyAuthority('INVENTORY_ADJUST','ROLE_ADMIN')">Điều chỉnh</a>
                            </div>
                        </td>
                    </tr>

                    <tr th:if="${page == null || #lists.isEmpty(page.content)}">
                        <td colspan="10" class="col-center" style="padding:18px;color:var(--muted);">Không có dữ liệu</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div th:replace="~{layout/components/_pagination :: body(page=${page}, baseUrl='/admin/inventory', q=${q})}"></div>
    </div>
</section>
</body>
</html>
