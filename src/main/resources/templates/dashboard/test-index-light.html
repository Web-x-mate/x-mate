<!doctype html>
<html lang="vi"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main}">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>B·∫£ng ƒëi·ªÅu khi·ªÉn</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>

    <style>
        /*
         * DARK MODE VARIABLES
         * N·ªÅn t·ªëi, b·ªÅ m·∫∑t t·ªëi (card), ch·ªØ s√°ng
         * M√†u s·∫Øc bi·ªÉu ƒë·ªì ƒë∆∞·ª£c tƒÉng ƒë·ªô b√£o h√≤a (s√°ng v√† ƒë·∫≠m h∆°n)
         */
        :root{
            /* Base Colors (Dark Mode) */
            --bg:#0f172a;               /* slate-900: N·ªÅn t·ªïng th·ªÉ */
            --surface:#1e293b;          /* slate-800: N·ªÅn Card */
            --text:#f8fafc;             /* slate-50: Ch·ªØ ch√≠nh */
            --muted:#94a3b8;            /* slate-400: Ch·ªØ ph·ª•/m·ªù */
            --bd:#334155;               /* slate-700: ƒê∆∞·ªùng vi·ªÅn/NgƒÉn c√°ch */
            --ring:#475569;             /* slate-600: Shadow/Ring */

            /* KPI & Status Colors */
            --up-bg:#064e3b;            /* M√†u n·ªÅn TƒÉng (xanh ƒë·∫≠m) */
            --up:#34d399;               /* M√†u ch·ªØ TƒÉng (xanh s√°ng) */
            --down-bg:#7f1d1d;          /* M√†u n·ªÅn Gi·∫£m (ƒë·ªè ƒë·∫≠m) */
            --down:#f87171;             /* M√†u ch·ªØ Gi·∫£m (ƒë·ªè s√°ng) */

            /* Icon Backgrounds (Dark Mode - √≠t b√£o h√≤a h∆°n n·ªÅn s√°ng) */
            --ico-blue-bg:#172554;      /* M√†u n·ªÅn icon */
            --ico-blue:#38bdf8;         /* M√†u icon */
            --ico-green-bg:#14532d;
            --ico-green:#4ade80;
            --ico-purple-bg:#312e81;
            --ico-purple:#a78bfa;
            --ico-orange-bg:#7c2d12;
            --ico-orange:#fb923c;
            --ico-gray-bg:#334155;
            --ico-gray:#e5e7eb;
        }

        /* Chart Colors (TƒÉng ƒë·ªô b√£o h√≤a/ƒë·ªô s√°ng cho n·ªÅn ƒëen) */
        .chart-colors {
            --chart-blue: #38bdf8;      /* Sky-400 */
            --chart-red: #f87171;       /* Red-400 */
            --chart-orange: #fb923c;    /* Orange-400 */
            --chart-yellow: #facc15;    /* Yellow-400 */
            --chart-green: #4ade80;     /* Green-400 */
            --chart-purple: #a78bfa;    /* Violet-400 */
            --chart-pink: #f472b6;      /* Pink-400 */
        }

        /* √Åp d·ª•ng m√†u n·ªÅn/ch·ªØ */
        body{background:var(--bg); color:var(--text)}
        .wrap{max-width:1360px;margin:0 auto}
        .card{background:var(--surface);border:1px solid var(--bd);border-radius:1rem;box-shadow:0 2px 4px rgba(0,0,0,.5)} /* Shadow m·∫°nh h∆°n cho dark mode */
        .muted{color:var(--muted)}
        .btn{padding:.45rem .7rem;border-radius:.55rem;border:1px solid var(--bd);font-size:.875rem;background:var(--surface);color:var(--text)}
        .btn:hover{background:var(--ring)} /* ƒê·ªïi m√†u hover cho d·ªÖ th·∫•y */

        input[type="date"], select{background:var(--surface);color:var(--text);border:1px solid var(--bd);outline:none}
        input[type="date"]:focus, select:focus{box-shadow:0 0 0 3px var(--ring)}

        /* ... gi·ªØ nguy√™n c√°c class layout kh√°c ... */
        .filter-grid{
            display:grid;
            grid-template-columns: minmax(520px,1fr) auto auto;
            align-items:center;
            column-gap:.5rem; row-gap:.35rem;
        }
        .field-inline{display:flex; align-items:center; gap:.4rem; flex-wrap:nowrap}
        .field-wrap{display:flex; align-items:center; gap:.75rem; flex-wrap:wrap}
        .filter-presets{
            grid-column: 1 / 2;
            display:flex; justify-content:center; gap:.5rem; flex-wrap:wrap; margin-top:.2rem;
        }
        .ctl{ font-size:.92rem; padding:.45rem .6rem; border-radius:.5rem; }
        .ctl-select{ font-size:.92rem; padding:.45rem 2rem .45rem .6rem; border-radius:.5rem; }

        .kpi{display:flex;gap:.75rem;align-items:center;padding:.85rem;background:var(--surface);border:1px solid var(--bd);border-radius:1rem;min-height:84px}
        .ico{flex:0 0 42px;height:42px;display:grid;place-items:center;border-radius:.85rem}
        .ico.blue{background:var(--ico-blue-bg);color:var(--ico-blue)}
        .ico.green{background:var(--ico-green-bg);color:var(--ico-green)}
        .ico.purple{background:var(--ico-purple-bg);color:var(--ico-purple)}
        .ico.orange{background:var(--ico-orange-bg);color:var(--ico-orange)}
        .ico.gray{background:var(--ico-gray-bg);color:var(--ico-gray)}
        .kmain{min-width:0; flex:1}
        .kval{font-size:1.45rem;line-height:1;font-weight:800; font-variant-numeric:tabular-nums}
        .kcap{font-size:.84rem;color:var(--muted);margin-top:.2rem;white-space:nowrap}
        .kright{margin-left:.4rem; display:flex; align-items:center}
        .chip{display:inline-flex;align-items:center;gap:.3rem;padding:.18rem .55rem;border-radius:999px;font-weight:700;font-size:.74rem;white-space:nowrap}
        .chip.up{background:var(--up-bg);color:var(--up)}
        .chip.down{background:var(--down-bg);color:var(--down)}
        canvas.small-pie{max-height:200px!important}
    </style>
</head>

<body class="chart-colors"> <section layout:fragment="content">
    <div class="wrap p-3 md:p-5 space-y-4">

        <div class="card p-3 md:p-4">
            <h1 class="text-2xl md:text-3xl font-bold mb-2">B·∫£ng ƒëi·ªÅu khi·ªÉn</h1>

            <div class="filter-grid">
                <div class="field-wrap">
                    <div class="field-inline">
                        <span class="text-base">T·ª´</span>
                        <input id="from" type="date" class="ctl"/>
                        <span class="muted">üìÖ</span>
                    </div>

                    <span class="muted">‚Üí</span>

                    <div class="field-inline">
                        <span class="text-base">ƒê·∫øn</span>
                        <input id="to" type="date" class="ctl"/>
                        <span class="muted">üìÖ</span>
                    </div>

                    <div class="filter-presets">
                        <button type="button" data-preset="today"  class="btn">H√¥m nay</button>
                        <button type="button" data-preset="7d"     class="btn">7 ng√†y</button>
                        <button type="button" data-preset="30d"    class="btn">30 ng√†y</button>
                        <button type="button" data-preset="12m"    class="btn">12 th√°ng</button>
                    </div>
                </div>

                <select id="gran" class="ctl-select">
                    <option value="D">Theo ng√†y</option>
                    <option value="W">Theo tu·∫ßn</option>
                    <option value="M">Theo th√°ng</option>
                </select>

                <button id="apply" type="button"
                        class="px-4 py-2 rounded-lg text-sm font-medium"
                        style="background:var(--chart-blue);color:#0f172a">√Åp d·ª•ng</button>
            </div>
        </div>

        <section class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-5 gap-3">
            <div class="kpi">
                <div class="ico blue"><svg viewBox="0 0 24 24" class="w-5 h-5" fill="currentColor"><path d="M6 4a2 2 0 0 0-2 2v12.5A1.5 1.5 0 0 0 5.5 20H20v-2H6.5a.5.5 0 1 1 0-1H20V6a2 2 0 0 0-2-2H6z"/></svg></div>
                <div class="kmain"><div class="kval" id="k_articles">0</div><div class="kcap truncate">T·ªïng b√†i vi·∫øt</div></div>
                <div class="kright"><span id="t_articles" class="chip up">+0%</span></div>
            </div>
            <div class="kpi">
                <div class="ico green"><svg viewBox="0 0 24 24" class="w-5 h-5" fill="currentColor"><path d="M4 19h16v2H2V3h2v16zm3-6 3-3 3 2 4-5 3 3-1.4 1.4-1.6-1.6-4 5-3-2-3 3L7 13z"/></svg></div>
                <div class="kmain"><div class="kval" id="k_views">0</div><div class="kcap truncate">L∆∞·ª£t xem trang</div></div>
                <div class="kright"><span id="t_views" class="chip up">+0%</span></div>
            </div>
            <div class="kpi">
                <div class="ico purple"><svg viewBox="0 0 24 24" class="w-5 h-5" fill="currentColor"><path d="M4 4h16v10H6l-2 2V4zm2 4h12v2H6V8z"/></svg></div>
                <div class="kmain"><div class="kval" id="k_comments">0</div><div class="kcap truncate">B√¨nh lu·∫≠n</div></div>
                <div class="kright"><span id="t_comments" class="chip up">+0%</span></div>
            </div>
            <div class="kpi">
                <div class="ico orange"><svg viewBox="0 0 24 24" class="w-5 h-5" fill="currentColor"><path d="M16 11a4 4 0 1 0-8 0 4 4 0 0 0 8 0zm-9 7a6 6 0 1 1 12 0v2H7v-2z"/></svg></div>
                <div class="kmain"><div class="kval" id="k_authors">0</div><div class="kcap truncate">T√°c gi·∫£</div></div>
                <div class="kright"><span id="t_authors" class="chip down">-0%</span></div>
            </div>
            <div class="kpi">
                <div class="ico gray"><svg viewBox="0 0 24 24" class="w-5 h-5" fill="currentColor"><path d="M21 5H3v14h18V5zm-2 2v7l-4-4-3 3-2-2-5 5V7h14z"/></svg></div>
                <div class="kmain"><div class="kval" id="k_media">0</div><div class="kcap truncate">T·ªáp media</div></div>
                <div class="kright"><span id="t_media" class="chip up">+0%</span></div>
            </div>
        </section>

        <section class="grid grid-cols-1 xl:grid-cols-2 gap-5">
            <div class="card p-4">
                <div class="flex items-center justify-between mb-2">
                    <h3 class="font-semibold">Hi·ªáu su·∫•t n·ªôi dung</h3>
                    <span class="px-2 py-1 rounded-full text-xs" style="background:rgba(167,139,250,.2);color:#a78bfa">12 th√°ng qua</span>
                </div>
                <canvas id="c_perf"></canvas>
            </div>
            <div class="card p-4">
                <div class="flex items-center justify-between mb-2">
                    <h3 class="font-semibold">N·ªôi dung theo danh m·ª•c</h3>
                    <span class="px-2 py-1 rounded-full text-xs" style="background:rgba(167,139,250,.2);color:#a78bfa">NƒÉm nay</span>
                </div>
                <canvas id="c_cat"></canvas>
            </div>
        </section>

        <section class="grid grid-cols-1 xl:grid-cols-2 gap-5">
            <div class="card p-4"><div class="flex items-center justify-between mb-2"><h3 class="font-semibold">L·ªãch s·ª≠ h·ªá th·ªëng</h3><a href="#" class="muted hover:underline text-sm">Xem t·∫•t c·∫£</a></div><canvas id="c_sys" class="small-pie"></canvas></div>
            <div class="card p-4"><div class="flex items-center justify-between mb-2"><h3 class="font-semibold">Ho·∫°t ƒë·ªông ng∆∞·ªùi d√πng</h3><a href="#" class="muted hover:underline text-sm">Xem t·∫•t c·∫£</a></div><canvas id="c_user"></canvas></div>
        </section>

        <section class="grid grid-cols-1 xl:grid-cols-3 gap-5">
            <div class="card p-4"><div class="flex items-center justify-between mb-2"><h3 class="font-semibold">·∫¢nh ch·ª•p Catalog</h3><span class="muted text-xs">ng√†nh h√†ng / s·∫£n ph·∫©m / bi·∫øn th·ªÉ / media</span></div><canvas id="c_catalog"></canvas></div>
            <div class="card p-4"><div class="flex items-center justify-between mb-2"><h3 class="font-semibold">RBAC: Vai tr√≤ √ó Quy·ªÅn</h3><span class="muted text-xs">roles / permissions</span></div><canvas id="c_rbac"></canvas></div>
            <div class="card p-4"><div class="flex items-center justify-between mb-2"><h3 class="font-semibold">Nh·∫≠t k√Ω (24h)</h3><span class="muted text-xs">CREATE / UPDATE / DELETE / STATUS</span></div><canvas id="c_logs" class="small-pie"></canvas></div>
        </section>

        <section class="grid grid-cols-1 xl:grid-cols-2 gap-5">
            <div class="card p-4"><div class="flex items-center justify-between mb-2"><h3 class="font-semibold">T·ªìn kho: c√≥ s·∫µn vs gi·ªØ ch·ªó</h3><span class="muted text-xs">SKU</span></div><canvas id="c_stock"></canvas></div>
            <div class="card p-4"><div class="flex items-center justify-between mb-2"><h3 class="font-semibold">ƒê∆°n mua theo tr·∫°ng th√°i</h3><span class="muted text-xs">PO</span></div><canvas id="c_po" class="small-pie"></canvas></div>
        </section>

        <section class="grid grid-cols-1 xl:grid-cols-3 gap-5">
            <div class="card p-4"><div class="flex items-center justify-between mb-2"><h3 class="font-semibold">Ph√¢n b·ªë ph√¢n kh√∫c KH</h3><span class="muted text-xs">segments</span></div><canvas id="c_seg" class="small-pie"></canvas></div>
            <div class="card p-4"><div class="flex items-center justify-between mb-2"><h3 class="font-semibold">ƒêi·ªÉm t√≠ch l≈©y theo h·∫°ng</h3><span class="muted text-xs">loyalty</span></div><canvas id="c_loy"></canvas></div>
            <div class="card p-4"><div class="flex items-center justify-between mb-2"><h3 class="font-semibold">Hi·ªáu qu·∫£ khuy·∫øn m√£i</h3><span class="muted text-xs">discounts + usages</span></div><canvas id="c_disc"></canvas></div>
        </section>

        <section class="grid grid-cols-1 xl:grid-cols-3 gap-5">
            <div class="card overflow-hidden">
                <div class="p-4 border-b" style="border-color:var(--bd)"><div class="flex items-center justify-between"><h3 class="font-semibold">ƒê∆°n g·∫ßn nh·∫•t</h3><a href="#" class="muted hover:underline text-sm">Xem t·∫•t c·∫£</a></div></div>
                <div class="p-4 overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="text-left muted"><tr><th class="py-2">M√£</th><th class="py-2">Kh√°ch</th><th class="py-2">T·ªïng</th><th class="py-2">TT</th><th class="py-2">Giao</th><th class="py-2">Ng√†y</th></tr></thead>
                        <tbody id="t_orders"></tbody>
                    </table>
                </div>
            </div>
            <div class="card overflow-hidden">
                <div class="p-4 border-b" style="border-color:var(--bd)"><div class="flex items-center justify-between"><h3 class="font-semibold">SKU t·ªìn th·∫•p</h3><a href="#" class="muted hover:underline text-sm">T·ªõi kho</a></div></div>
                <div class="p-4 overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="text-left muted"><tr><th class="py-2">SKU</th><th class="py-2">T√™n</th><th class="py-2">C√≥ s·∫µn</th><th class="py-2">Gi·ªØ ch·ªó</th></tr></thead>
                        <tbody id="t_low"></tbody>
                    </table>
                </div>
            </div>
            <div class="card overflow-hidden">
                <div class="p-4 border-b" style="border-color:var(--bd)"><div class="flex items-center justify-between"><h3 class="font-semibold">PO ƒëang nh·∫≠n</h3><a href="#" class="muted hover:underline text-sm">T·ªõi mua h√†ng</a></div></div>
                <div class="p-4 overflow-x-auto">
                    <table class="w-full text-sm">
                        <thead class="text-left muted"><tr><th class="py-2">PO</th><th class="py-2">Nh√† cung c·∫•p</th><th class="py-2">Tr·∫°ng th√°i</th><th class="py-2">ƒê√£ nh·∫≠n/T·ªïng</th></tr></thead>
                        <tbody id="t_po"></tbody>
                    </table>
                </div>
            </div>
        </section>
    </div>

    <script>
        const DASHBOARD = {
            kpis:{ totalArticles:1247, pageViews:89200, comments:2847, activeAuthors:24, mediaFiles:3456,
                deltaArticles:12.5, deltaViews:23.1, deltaComments:8.2, deltaAuthors:-2.1, deltaMedia:15.7 },
            performance:{ labels:["01","02","03","04","05","06","07","08","09","10","11","12"],
                articles:[45,52,49,61,55,70,72,68,80,77,83,86],
                pageViewsK:[11,12,13,16,15,22,24,23,28,27,29,34] },
            category:{ labels:["C√¥ng ngh·ªá","Kinh doanh","S·ª©c kh·ªèe","Th·ªÉ thao","Gi·∫£i tr√≠","Ch√≠nh tr·ªã","Khoa h·ªçc"], values:[158,145,98,88,76,70,60] },
            system:{ labels:["T·∫°o","S·ª≠a","X√≥a","Tr·∫°ng th√°i"], values:[35,42,7,16] },
            userActivity:{ labels:["ƒêƒÉng nh·∫≠p","S·ª≠a","Xu·∫•t b·∫£n","B√¨nh lu·∫≠n","Th√≠ch"], values:[120,80,45,200,300] },
            catalog:{ labels:["Ng√†nh h√†ng","S·∫£n ph·∫©m","Bi·∫øn th·ªÉ","Media"], values:[12,154,423,786] },
            rbac:{ labels:["Admin","Bi√™n t·∫≠p","T√°c gi·∫£","Xem"], values:[12,34,24,58] },
            activity:{ labels:["T·∫°o","S·ª≠a","X√≥a","Tr·∫°ng th√°i"], values:[80,140,20,35] },
            stock:{ labels:["SKU-A","SKU-B","SKU-C","SKU-D","SKU-E","SKU-F"], onHand:[120,80,95,60,150,70], reserved:[20,10,15,5,30,12] },
            poStatus:{ labels:["Nh√°p","Ch·ªù","ƒêang nh·∫≠n","ƒê√£ h·∫°ch to√°n","H·ªßy"], values:[4,8,6,3,1] },
            segments:{ labels:["M·ªõi","Quay l·∫°i","VIP","Ng·ªß ƒë√¥ng"], values:[320,510,85,120] },
            loyalty:{ labels:["ƒê·ªìng","B·∫°c","V√†ng","B·∫°ch kim"], values:[1200,430,140,35] },
            discountEffect:{ labels:["SPRING10","FREESHIP","BLACKFRI","MEMBER5"], orders:[120,240,85,160], revenue:[24000000,36500000,17800000,22200000] },
            recentOrders:[
                {code:"#10021",customer:"Nguy·ªÖn A",total:1250000,paymentStatus:"PAID",shippingStatus:"SHIPPED",createdAt:"2025-10-21 09:14"},
                {code:"#10022",customer:"Tr·∫ßn B",total:850000,paymentStatus:"PAID",shippingStatus:"PENDING",createdAt:"2025-10-21 10:05"},
                {code:"#10023",customer:"L√™ C",total:2190000,paymentStatus:"PENDING",shippingStatus:"-",createdAt:"2025-10-21 11:44"},
                {code:"#10024",customer:"Ph·∫°m D",total:640000,paymentStatus:"PAID",shippingStatus:"DELIVERED",createdAt:"2025-10-21 12:12"}
            ],
            lowSkus:[
                {sku:"XM-AT-001-M",name:"√Åo thun A - M",onHand:5,reserved:3},
                {sku:"XM-AT-001-L",name:"√Åo thun A - L",onHand:4,reserved:2},
                {sku:"XM-QJ-002-32",name:"Qu·∫ßn jean B - 32",onHand:7,reserved:4},
                {sku:"XM-SN-003-42",name:"Sneaker C - 42",onHand:3,reserved:1}
            ],
            poReceiving:[
                {code:"PO-2401",supplier:"ABC Supply",status:"RECEIVING",receivedQty:120,totalQty:300},
                {code:"PO-2402",supplier:"XYZ Corp",status:"RECEIVING",receivedQty:40,totalQty:100},
                {code:"PO-2403",supplier:"Delta Ltd",status:"AWAITING",receivedQty:0,totalQty:80}
            ]
        };
    </script>

    <script>
        const $ = id=>document.getElementById(id);
        const money=v=>new Intl.NumberFormat('vi-VN',{style:'currency',currency:'VND'}).format(Number(v||0));
        const cssVar = name => getComputedStyle(document.body).getPropertyValue(name).trim();

        // 1. √ÅP D·ª§NG M√ÄU CHUNG (ƒê·∫¨M H∆†N/S√ÅNG H∆†N CHO DARK MODE)
        const primaryColor = cssVar('--chart-blue');
        const secondaryColor = cssVar('--chart-red');
        const tertiaryColor = cssVar('--chart-orange');
        const quaternaryColor = cssVar('--chart-yellow');
        const quinaryColor = cssVar('--chart-green');
        const senaryColor = cssVar('--chart-purple');

        const multiColors = [primaryColor, secondaryColor, tertiaryColor, quaternaryColor, quinaryColor, senaryColor, cssVar('--chart-pink')];

        // C·∫•u h√¨nh chung cho Chart.js ƒë·ªÉ t·ªëi ∆∞u cho Dark Mode
        Chart.defaults.color = cssVar('--muted'); // M√†u ch·ªØ tr√™n bi·ªÉu ƒë·ªì (nh√£n, tr·ª•c)
        Chart.defaults.borderColor = cssVar('--bd'); // M√†u ƒë∆∞·ªùng l∆∞·ªõi/vi·ªÅn

        const toISODate=d=>new Date(d.getTime()-d.getTimezoneOffset()*60000).toISOString().slice(0,10);
        const setRange=k=>{const to=new Date(), from=new Date(); if(k==='today'){} else if(k==='7d'){from.setDate(to.getDate()-6)} else if(k==='30d'){from.setDate(to.getDate()-29)} else {from.setMonth(to.getMonth()-11)}; $('from').value=toISODate(from); $('to').value=toISODate(to);};
        setRange('12m');
        document.querySelectorAll('[data-preset]').forEach(b=>b.addEventListener('click',()=>setRange(b.dataset.preset)));
        $('apply').addEventListener('click',()=>{/* g·ªçi API th·∫≠t n·∫øu c·∫ßn */});

        const k=DASHBOARD.kpis; const pct=(el,v)=>{const n=Number(v||0); el.textContent=(n>=0?'+':'')+n.toFixed(1)+'%'; el.className='chip '+(n>=0?'up':'down');};
        $('k_articles').textContent=(k.totalArticles||0).toLocaleString('vi-VN');
        $('k_views').textContent=(k.pageViews||0).toLocaleString('vi-VN');
        $('k_comments').textContent=(k.comments||0).toLocaleString('vi-VN');
        $('k_authors').textContent=k.activeAuthors||0;
        $('k_media').textContent=(k.mediaFiles||0).toLocaleString('vi-VN');
        pct($('t_articles'),k.deltaArticles); pct($('t_views'),k.deltaViews); pct($('t_comments'),k.deltaComments); pct($('t_authors'),k.deltaAuthors); pct($('t_media'),k.deltaMedia);

        const make=(el,type,labels,sets,opts)=> new Chart(el,{type,data:{labels,datasets:sets},options:opts||{}});
        const pf=DASHBOARD.performance;
        make($('c_perf'),'line', pf.labels,[
            {label:'B√†i vi·∫øt xu·∫•t b·∫£n',data:pf.articles,tension:.35,fill:true, backgroundColor:'rgba(56,189,248,0.2)', borderColor:primaryColor, pointBackgroundColor:primaryColor}, // Xanh s√°ng
            {label:'L∆∞·ª£t xem (ngh√¨n)',data:pf.pageViewsK,tension:.35,fill:true, backgroundColor:'rgba(74,222,128,0.2)', borderColor:quinaryColor, pointBackgroundColor:quinaryColor} // Xanh l√° s√°ng
        ],{plugins:{legend:{position:'top'}}});

        const cat=DASHBOARD.category;
        make($('c_cat'),'bar', cat.labels,[{label:'B√†i vi·∫øt',data:cat.values, backgroundColor:multiColors}],{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}});

        make($('c_sys'),'pie', DASHBOARD.system.labels,[{
            data:DASHBOARD.system.values,
            backgroundColor: [primaryColor, secondaryColor, tertiaryColor, quinaryColor]
        }],{plugins:{legend:{position:'bottom'}}});

        make($('c_user'),'bar', DASHBOARD.userActivity.labels,[{label:'T√°c v·ª•',data:DASHBOARD.userActivity.values, backgroundColor:primaryColor}],{scales:{y:{beginAtZero:true}}});

        make($('c_catalog'),'bar', DASHBOARD.catalog.labels,[{label:'S·ªë l∆∞·ª£ng',data:DASHBOARD.catalog.values, backgroundColor:primaryColor}],{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}});

        make($('c_rbac'),'bar', DASHBOARD.rbac.labels,[{label:'Quy·ªÅn/role',data:DASHBOARD.rbac.values, backgroundColor:primaryColor}],{plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}});

        make($('c_logs'),'doughnut', DASHBOARD.activity.labels,[{
            data:DASHBOARD.activity.values,
            backgroundColor: [primaryColor, secondaryColor, tertiaryColor, quinaryColor]
        }],{plugins:{legend:{position:'bottom'}}});

        make($('c_stock'),'bar', DASHBOARD.stock.labels,[
            {label:'C√≥ s·∫µn',data:DASHBOARD.stock.onHand, backgroundColor:primaryColor},
            {label:'Gi·ªØ ch·ªó',data:DASHBOARD.stock.reserved, backgroundColor:secondaryColor}
        ],{scales:{y:{beginAtZero:true}}});

        make($('c_po'),'pie', DASHBOARD.poStatus.labels,[{
            data:DASHBOARD.poStatus.values,
            backgroundColor: [tertiaryColor, primaryColor, quinaryColor, secondaryColor, senaryColor] // ƒê·ªïi th·ª© t·ª±/m√†u ƒë·ªÉ n·ªïi b·∫≠t h∆°n
        }],{plugins:{legend:{position:'bottom'}}});

        make($('c_seg'),'pie', DASHBOARD.segments.labels,[{
            data:DASHBOARD.segments.values,
            backgroundColor: [primaryColor, secondaryColor, tertiaryColor, quinaryColor]
        }],{plugins:{legend:{position:'bottom'}}});

        make($('c_loy'),'bar', DASHBOARD.loyalty.labels,[{label:'ƒêi·ªÉm',data:DASHBOARD.loyalty.values, backgroundColor:primaryColor}],{scales:{y:{beginAtZero:true}}});

        make($('c_disc'),'bar', DASHBOARD.discountEffect.labels,[
            {label:'S·ªë ƒë∆°n',data:DASHBOARD.discountEffect.orders, backgroundColor:primaryColor, yAxisID:'y'},
            {label:'Doanh thu',data:DASHBOARD.discountEffect.revenue, backgroundColor:secondaryColor, yAxisID:'y1'}
        ],{
            scales:{
                y:{beginAtZero:true},
                y1:{beginAtZero:true,position:'right',ticks:{callback:v=>money(v)}, grid:{drawOnChartArea:false}}
            },
            plugins:{legend:{position:'top'}}
        });

        // 2. RENDERING B·∫¢NG
        $('t_orders').innerHTML=DASHBOARD.recentOrders.map(r=>`
      <tr class="border-t" style="border-color:var(--bd)">
        <td class="py-2 font-medium">${r.code}</td>
        <td class="py-2">${r.customer}</td>
        <td class="py-2">${money(r.total)}</td>
        <td class="py-2"><span class="px-2 py-0.5 rounded-full text-xs" style="background:rgba(255,255,255,.1); color:var(--text)">${r.paymentStatus}</span></td>
        <td class="py-2"><span class="px-2 py-0.5 rounded-full text-xs" style="background:rgba(255,255,255,.1); color:var(--text)">${r.shippingStatus}</span></td>
        <td class="py-2 muted">${r.createdAt}</td>
      </tr>`).join('');
        $('t_low').innerHTML=DASHBOARD.lowSkus.map(r=>`
      <tr class="border-t" style="border-color:var(--bd)">
        <td class="py-2 font-mono">${r.sku}</td>
        <td class="py-2">${r.name}</td>
        <td class="py-2">${r.onHand}</td>
        <td class="py-2">${r.reserved}</td>
      </tr>`).join('');
        $('t_po').innerHTML=DASHBOARD.poReceiving.map(r=>`
      <tr class="border-t" style="border-color:var(--bd)">
        <td class="py-2 font-mono">${r.code}</td>
        <td class="py-2">${r.supplier}</td>
        <td class="py-2"><span class="px-2 py-0.5 rounded-full text-xs" style="background:rgba(255,255,255,.1); color:var(--text)">${r.status}</span></td>
        <td class="py-2">${r.receivedQty}/${r.totalQty}</td>
      </tr>`).join('');
    </script>
</section>
</body>
</html>