<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
        :root{--bg:#0f172a;--card:#111827;--muted:#94a3b8;--txt:#e5e7eb;--brand:#22c55e}
        html,body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--txt)}
        .wrap{max-width:1100px;margin:0 auto;padding:24px}
        .top{display:flex;align-items:center;gap:16px;justify-content:space-between}
        .brand{display:flex;align-items:center;gap:12px}
        .brand .dot{width:12px;height:12px;border-radius:999px;background:var(--brand)}
        .card{background:var(--card);border-radius:16px;padding:18px;border:1px solid #1f2937;box-shadow:0 0 0 1px rgba(255,255,255,.02) inset}
        .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-top:16px}
        .muted{color:var(--muted);font-size:14px}
        .btn{background:#1f2937;color:#fff;border:1px solid #293241;border-radius:10px;padding:10px 14px;cursor:pointer}
        .btn:hover{background:#253041}
        nav a{color:#c7d2fe;text-decoration:none;margin-right:12px}
        table{width:100%;border-collapse:collapse}
        th,td{padding:10px;border-bottom:1px solid #1f2937;text-align:left}
        .pill{display:inline-block;padding:2px 10px;border-radius:999px;background:#0b1323;border:1px solid #1f2937;font-size:12px}
        @media (max-width:720px){.grid{grid-template-columns:1fr}}
    </style>
</head>
<body>
<div class="wrap">

    <header class="top">
        <

        <!-- User panel -->
        <div class="card" style="display:flex;align-items:center;gap:16px">
            <div>
                <div>Xin chào, <strong th:text="${#authentication.name}">admin</strong></div>
                <div class="muted">
                    Quyền:
                    <span th:each="a : ${#authentication.authorities}"
                          class="pill" th:text="${a.authority}">ROLE_ADMIN</span>
                </div>
            </div>

            <!-- Logout (POST + CSRF) -->
            <form th:action="@{/auth/logout}" method="post" style="margin-left:auto">
                <input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <button class="btn" type="submit">Đăng xuất</button>
            </form>
        </div>
    </header>

    <nav class="card" style="margin-top:16px">
        <a th:href="@{/admin/dashboard}">Tổng quan</a>
        <a th:href="@{/admin/users}">Người dùng</a>
        <a th:href="@{/admin/orders}">Đơn hàng</a>
        <a th:href="@{/admin/settings}">Cấu hình</a>
    </nav>

    <section class="grid">
        <!-- Widgets mẫu -->
        <div class="card">
            <h3 style="margin:4px 0 10px">Tóm tắt hệ thống</h3>
            <div class="muted">Bạn có thể đặt các số liệu tổng hợp ở đây (orders, doanh thu, v.v.).</div>
            <ul>
                <li>Đơn hàng hôm nay: <strong th:text="${statsTodayOrders}">0</strong></li>
                <li>Khách hàng mới: <strong th:text="${statsNewUsers}">0</strong></li>
                <li>Doanh thu ước tính: <strong th:text="${statsRevenue}">0</strong></li>
            </ul>
        </div>

        <div class="card">
            <h3 style="margin:4px 0 10px">Hành động nhanh</h3>
            <div class="muted">Các phím tắt quản trị.</div>
            <div style="margin-top:8px;display:flex;gap:8px;flex-wrap:wrap">
                <a class="btn" th:href="@{/admin/users}">Quản lý người dùng</a>
                <a class="btn" th:href="@{/admin/products}">Quản lý sản phẩm</a>
                <a class="btn" th:href="@{/admin/orders}">Quản lý đơn hàng</a>
            </div>
        </div>
    </section>

    <section class="card" style="margin-top:16px">
        <h3 style="margin:4px 0 10px">Hoạt động gần đây</h3>
        <table>
            <thead>
            <tr>
                <th>Thời gian</th>
                <th>Sự kiện</th>
                <th>Thực hiện bởi</th>
            </tr>
            </thead>
            <tbody>
            <!-- Ví dụ render danh sách log (nếu controller cấp model 'logs') -->
            <tr th:each="log : ${logs}">
                <td th:text="${#dates.format(log.time, 'HH:mm dd/MM')}">09:30 10/10</td>
                <td th:text="${log.message}">Tạo đơn hàng #123</td>
                <td th:text="${log.actor}">admin</td>
            </tr>

            <!-- Fallback khi chưa có dữ liệu -->
            <tr th:if="${logs == null or #lists.isEmpty(logs)}">
                <td colspan="3" class="muted">Chưa có dữ liệu.</td>
            </tr>
            </tbody>
        </table>
    </section>

</div>
</body>
</html>
